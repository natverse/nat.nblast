<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate similarity score for neuron morphologies — nblast • nat.nblast</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate similarity score for neuron morphologies — nblast"><meta name="description" content="Uses the NBLAST algorithm that compares the morphology of two neurons. For
more control over the parameters of the algorithm, see the arguments of
NeuriteBlast."><meta property="og:description" content="Uses the NBLAST algorithm that compares the morphology of two neurons. For
more control over the parameters of the algorithm, see the arguments of
NeuriteBlast."><meta property="og:image" content="https://natverse.org/nat.nblast/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nat.nblast</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/NBLAST-Clustering.html">NBLAST Clustering</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="../SUPPORT.html">Help</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://natverse.github.io">natverse</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/natverse/nat.nblast"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculate similarity score for neuron morphologies</h1>
      <small class="dont-index">Source: <a href="https://github.com/natverse/nat.nblast/blob/master/R/neuriteblast.r" class="external-link"><code>R/neuriteblast.r</code></a></small>
      <div class="d-none name"><code>nblast.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses the NBLAST algorithm that compares the morphology of two neurons. For
more control over the parameters of the algorithm, see the arguments of
<code><a href="NeuriteBlast.html">NeuriteBlast</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nblast</span><span class="op">(</span></span>
<span>  <span class="va">query</span>,</span>
<span>  target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"nat.default.neuronlist"</span><span class="op">)</span>,</span>
<span>  smat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  version <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  normalised <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  UseAlpha <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  OmitFailures <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-query">query<a class="anchor" aria-label="anchor" href="#arg-query"></a></dt>
<dd><p>the query neuron.</p></dd>


<dt id="arg-target">target<a class="anchor" aria-label="anchor" href="#arg-target"></a></dt>
<dd><p>a <code><a href="https://rdrr.io/pkg/nat/man/neuronlist.html" class="external-link">neuronlist</a></code> to compare neuron against.
Defaults to <code>options("nat.default.neuronlist")</code>. See
<code><a href="https://rdrr.io/pkg/nat/man/nat-package.html" class="external-link">nat-package</a></code>.</p></dd>


<dt id="arg-smat">smat<a class="anchor" aria-label="anchor" href="#arg-smat"></a></dt>
<dd><p>the scoring matrix to use (see details)</p></dd>


<dt id="arg-sd">sd<a class="anchor" aria-label="anchor" href="#arg-sd"></a></dt>
<dd><p>Standard deviation to use in distance dependence of NBLAST v1
algorithm. Ignored when <code>version=2</code>.</p></dd>


<dt id="arg-version">version<a class="anchor" aria-label="anchor" href="#arg-version"></a></dt>
<dd><p>the version of the algorithm to use (the default, 2, is the
latest).</p></dd>


<dt id="arg-normalised">normalised<a class="anchor" aria-label="anchor" href="#arg-normalised"></a></dt>
<dd><p>whether to divide scores by the self-match score of the
query</p></dd>


<dt id="arg-usealpha">UseAlpha<a class="anchor" aria-label="anchor" href="#arg-usealpha"></a></dt>
<dd><p>whether to weight the similarity score for each matched
segment to emphasise long range neurites rather then arbours (default:
FALSE, see <b><code>UseAlpha</code></b> section for details).</p></dd>


<dt id="arg-omitfailures">OmitFailures<a class="anchor" aria-label="anchor" href="#arg-omitfailures"></a></dt>
<dd><p>Whether to omit neurons for which <code>FUN</code> gives an
error. The default value (<code>NA</code>) will result in <code>nblast</code> stopping
with an error message the moment there is an error. For other values, see
details.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code><a href="NeuriteBlast.html">NeuriteBlast</a></code> or the
function used to compute scores from distances/dot products. (expert use
only).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Named list of similarity scores.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>when <code>smat=NULL</code> <code>options("nat.nblast.defaultsmat")</code> will
  be checked and if <code>NULL</code>, then <code>smat.fcwb</code> or
  <code>smat_alpha.fcwb</code> will be used depending on the value of
  <code>UseAlpha</code>.</p>
<p>When <code>OmitFailures</code> is not <code>NA</code>, individual nblast calls will be
  wrapped in <code>try</code> to ensure that failure for any single neuron does not
  abort the whole <code>nblast</code> call. When <code>OmitFailures=FALSE</code>, missing
  values will be left as <code>NA</code>. <code>OmitFailures=TRUE</code> is not (yet)
  implemented. If you want to drop scores for neurons that failed you will
  need to set <code>OmitFailures=FALSE</code> and then use <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></code> or
  similar to post-process the scores.</p>
<p>Note that when <code>OmitFailures=FALSE</code> error messages will not be printed
  because the call is wrapped as <code>try(expr, silent=TRUE)</code>.</p>
<p>Internally, the <code><a href="https://rdrr.io/pkg/plyr/man/plyr.html" class="external-link">plyr</a></code> package is used to provide options
  for parallelising NBLAST and displaying progress. To display a progress bar
  as the scores are computed, add <code>.progress="natprogress"</code> to the
  arguments (non-text progress bars are available – see
  <code><a href="https://rdrr.io/pkg/plyr/man/create_progress_bar.html" class="external-link">create_progress_bar</a></code>). To parallelise, add
  <code>.parallel=TRUE</code> to the arguments. In order to make use of parallel
  calculation, you must register a parallel backend that will distribute the
  computations. There are several possible backends, the simplest of which is
  the multicore option made available by <code>doMC</code>, which spreads the load
  across cores of the same machine. Before using this, the backend must be
  registered using <code>registerDoMC</code> (see example below).</p>
    </div>
    <div class="section level2">
    <h2 id="nblast-versions">NBLAST Versions<a class="anchor" aria-label="anchor" href="#nblast-versions"></a></h2>
    <p>The <code>nblast</code> version argument presently
  exposes two versions of the algorithm; both use the same core procedure of
  aligning two vector clouds, segment by segment, and then computing the
  distance and absolute dot product between the nearest segment in the target
  neuron for every segment in the query neuron. However they differ
  significantly in the procedure used to calculate a score using this set of
  distances and absolute dot products.</p>
<p><b>Version 1</b> of the algorithm uses a standard deviation (argument
  <code>sd</code>) as a user-supplied parameter for a negative exponential
  weighting function that determines the relationship between score and the
  distance between segments. This corresponds to the parameter \(\sigma\)
  in the weighting function:</p>
<p>\(f=\sqrt{|\vec{u_{i}}\cdot\vec{v_{i}}|\exp\left(-d_{i}^{2}/2\sigma^{2}\right)}\)</p>
<p>This is the same approach described in Kohl et al 2013 and the similarity
  scores in the interval (0,1) described in that paper can exactly
  recapitulated by setting <code>version=1</code> and <code>normalised=TRUE</code>.</p>
<p><b>Version 2</b> of the algorithm is described in Costa et al 2014. This
  uses a more sophisticated and principled scoring approach based on a
  log-odds ratio defined by the distribution of matches and non-matches in
  sample data. This information is passed to the <code>nblast</code> function in
  the form of a <em>scoring matrix</em> (which can be computed by
  <code><a href="create_scoringmatrix.html">create_scoringmatrix</a></code>); a default scoring matrix
  <code><a href="smat.fcwb.html">smat.fcwb</a></code> has been constructed for <em>Drosophila</em> neurons.</p>
<p><b>Which version should I use?</b> You should use version 2 if you are
  working with <em>Drosophila</em> neurons or you have sufficient training data
  (in the form of validated matching and random neuron pairs to construct a
  scoring matrix). If this is not the case, you can always fall back to
  version 1, setting the free parameter (sd or \(\sigma\)) to a value that
  encapsulates your understanding of the location precision of neurons in
  your species/brain region of interest. In the fly brain we have used
  \(\sigma=3\) microns, since previous estimates of the localisation of
  identifiable features of neurons (Jefferis, Potter et al 2007) are of this
  order.</p>
    </div>
    <div class="section level2">
    <h2 id="usealpha"><code>UseAlpha</code><a class="anchor" aria-label="anchor" href="#usealpha"></a></h2>
    <p>In NBLAST v2, the alpha factor for a segment
  indicates whether neighbouring segments are aligned in a similar direction
  (as typical for e.g. a long range axonal projection) or randomly aligned
  (as typical for dendritic arbours). See Costa et al. for details. Setting
  <code>UseAlpha=TRUE</code> will emphasise the axon, primary neurite etc. of a
  neuron. This can be a particularly useful option e.g. when you are
  searching by a traced fragment that you know or suspect to follow an axon
  tract.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kohl, J. Ostrovsky, A.D., Frechter, S., and Jefferis, G.S.X.E
  (2013). A bidirectional circuit switch reroutes pheromone signals in male
  and female brains. Cell 155 (7), 1610–23 <a href="https://doi.org/10.1016/j.cell.2013.11.025" class="external-link">doi:10.1016/j.cell.2013.11.025</a>
.</p>
<p>Costa, M., Ostrovsky, A.D., Manton, J.D., Prohaska, S., and Jefferis,
  G.S.X.E. (2014). NBLAST: Rapid, sensitive comparison of neuronal structure
  and construction of neuron family databases. bioRxiv preprint.
  <a href="https://doi.org/10.1101/006346" class="external-link">doi:10.1101/006346</a>
.</p>
<p>Jefferis G.S.X.E., Potter C.J., Chan A.M., Marin E.C., Rohlfing T., Maurer
  C.R.J., and Luo L. (2007). Comprehensive maps of Drosophila higher
  olfactory centers: spatially segregated fruit and pheromone representation.
  Cell 128 (6), 1187–1203. <a href="https://doi.org/10.1016/j.cell.2007.01.040" class="external-link">doi:10.1016/j.cell.2007.01.040</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/nat/man/nat-package.html" class="external-link">nat-package</a></code>, <code><a href="nblast_allbyall.html">nblast_allbyall</a></code>,
  <code><a href="create_scoringmatrix.html">create_scoringmatrix</a></code>, <code><a href="smat.fcwb.html">smat.fcwb</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># load sample Kenyon cell data from nat package</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">kcs20</span>, package<span class="op">=</span><span class="st">'nat'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># search one neuron against all neurons</span></span></span>
<span class="r-in"><span><span class="va">scores</span><span class="op">=</span><span class="fu">nblast</span><span class="op">(</span><span class="va">kcs20</span><span class="op">[[</span><span class="st">'GadMARCM-F000142_seg002'</span><span class="op">]</span><span class="op">]</span>, <span class="va">kcs20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># scores from best to worst, top hit is of course same neuron</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">scores</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GadMARCM-F000142_seg002 ChaMARCM-F000586_seg002 GadMARCM-F000423_seg001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               4043.1766               1914.8224               1772.8506 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GadMARCM-F000442_seg002 FruMARCM-M000115_seg001 FruMARCM-F000085_seg001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               1007.4565                853.8108                713.2106 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FruMARCM-F001929_seg001 FruMARCM-F001494_seg002 GadMARCM-F000050_seg001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                604.4071                481.4737                480.4146 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GadMARCM-F000071_seg001 FruMARCM-M001339_seg001 FruMARCM-F000188_seg001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                448.1516                433.9340                404.0470 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GadMARCM-F000476_seg001 FruMARCM-F000270_seg001 FruMARCM-F000706_seg001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                313.2021                254.7516                204.2116 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FruMARCM-M000842_seg002 FruMARCM-M001051_seg002 FruMARCM-M001205_seg002 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                196.4543                140.8164               -251.4999 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GadMARCM-F000122_seg001 FruMARCM-F001115_seg002 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               -262.2352               -520.2581 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">scores</span>, breaks<span class="op">=</span><span class="fl">25</span>, col<span class="op">=</span><span class="st">'grey'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">1500</span>, col<span class="op">=</span><span class="st">'red'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="nblast-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot query neuron</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/open3d.html" class="external-link">open3d</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># plot top 3 hits (including self match with thicker lines)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="va">kcs20</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">scores</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">1500</span><span class="op">)</span><span class="op">]</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rest</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">scores</span><span class="op">&lt;</span><span class="fl">1500</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="va">rest</span>, db<span class="op">=</span><span class="va">kcs20</span>, col<span class="op">=</span><span class="st">'grey'</span>, lwd<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># normalised scores (i.e. self match = 1) of all neurons vs each other</span></span></span>
<span class="r-in"><span><span class="co"># note use of progress bar</span></span></span>
<span class="r-in"><span><span class="va">scores.norm</span><span class="op">=</span><span class="fu">nblast</span><span class="op">(</span><span class="va">kcs20</span>, <span class="va">kcs20</span>, normalised <span class="op">=</span> <span class="cn">TRUE</span>, .progress<span class="op">=</span><span class="st">"natprogress"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Cannot find progress bar progress_natprogress</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">scores.norm</span>, breaks<span class="op">=</span><span class="fl">25</span>, col<span class="op">=</span><span class="st">'grey'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="nblast-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># produce a heatmap from normalised scores</span></span></span>
<span class="r-in"><span><span class="va">jet.colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"yellow"</span>, <span class="st">"red"</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap</a></span><span class="op">(</span><span class="va">scores.norm</span>, labCol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">kcs20</span>,<span class="va">type</span><span class="op">)</span>, col<span class="op">=</span><span class="fu">jet.colors</span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>, symm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="nblast-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Parallelise NBLASTing across 4 cores using doMC package</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">doMC</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">registerDoMC</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">scores.norm2</span><span class="op">=</span><span class="fu">nblast</span><span class="op">(</span><span class="va">kcs20</span>, <span class="va">kcs20</span>, normalised<span class="op">=</span><span class="cn">TRUE</span>, .parallel<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">scores.norm2</span>, <span class="va">scores.norm</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gregory Jefferis, James Manton.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

